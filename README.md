# Kluis OS 운영체제 설계 문서

## 🎯 개요
**Kluis OS**는 VM 기반의 애플리케이션 실행 환경을 제공하는 사용자 친화적 운영체제입니다.  
**편의성을 최우선**으로 하며, 사용자가 VM을 쉽게 인식하고 조작할 수 있으면서도 투명한 사용 경험을 제공합니다.

---

## 🏗️ 핵심 아키텍처
### 호스트 시스템
- **기반 OS**: Arch Linux
- **데스크톱 환경**: KDE Plasma
- **디스플레이 서버**: Wayland
- **설치 도구**: Anaconda installer

### 가상화 환경
- **VM 엔진**: QEMU/KVM
- **VM 명칭**: Kluis
- **관리 도구**: Kluis Manager
- **실행 방식**: 대부분의 사용자 애플리케이션이 Kluis VM 내에서 실행

---

## ✨ 핵심 기능

### 1. 유연한 심리스 모드
- **기본 상태**: 심리스 모드 활성화 (VM과 호스트 간 경계 최소화)
- **비심리스 실행**: `--windowed` 또는 `--isolated` 플래그로 일회성 독립 윈도우 실행
- **초기 설정**: 새 VM 생성 시에는 셋업을 위해 심리스 모드 비활성화

### 2. 직관적 VM 관리
- VM 존재를 명확히 인식 가능한 UI
- 간단한 클릭으로 VM 생성, 시작, 중지
- 실시간 VM 상태 모니터링

### 3. 데이터 공유
- **클립보드**: 호스트 ↔ VM, VM ↔ VM 간 실시간 동기화
- **파일시스템**: 설정 가능한 공유 폴더

### 4. 통합 애플리케이션 실행
- 호스트 데스크톱에서 VM 내 프로그램 직접 실행
- 애플리케이션별 VM 지정 가능

---

## 🔧 시스템 구조
### 호스트 레벨
```
Kluis OS (Arch Linux 기반)
├── KDE Plasma (Wayland)
├── Kluis Manager (VM 관리)
├── 시스템 서비스 최소화
└── VM Runtime Environment
```

### VM 레벨
```
Kluis VM Instances
├── 사용자 애플리케이션
├── Kluis Agent (호스트 통신)
├── 공유 서비스
└── 경량 게스트 OS
```

---

## 🛠️ 주요 컴포넌트

### Kluis Manager
- VM 생성, 관리, 모니터링
- 리소스 할당 및 네트워크 설정
- 스냅샷 및 백업

### Kluis Agent
- 호스트-게스트 통신
- 클립보드 및 파일 동기화
- 심리스 모드 구현

---

## 💻 CLI 도구 - kluis

### 기본 VM 관리
```bash
# VM 라이프사이클
kluis create <name> [template]        # 새 VM 생성 (비심리스 모드)
kluis start <name>                    # VM 시작 (심리스 모드)
kluis start <name> --windowed         # 독립 윈도우로 시작
kluis stop <name>                     # VM 중지
kluis list                            # VM 목록 및 상태
kluis delete <name>                   # VM 삭제

# 애플리케이션 실행
kluis run <app> [vm]                  # 심리스 모드로 실행
kluis run <app> [vm] --windowed       # 독립 윈도우로 실행
```

### 관리 기능
```bash
# 스냅샷
kluis snapshot <vm> <name>            # 스냅샷 생성
kluis restore <vm> <name>             # 스냅샷 복원

# 템플릿
kluis template create <name> <vm>     # 템플릿 생성
kluis template list                   # 템플릿 목록

# 설정
kluis config seamless <vm> on/off     # 심리스 모드 기본값 설정
kluis config share <vm> <path>        # 공유 폴더 설정

# 시스템
kluis status                          # 전체 시스템 상태
kluis monitor                         # 리소스 모니터링
```

---

## 🖥️ GUI 관리 도구 - Kluis Control Center

### 메인 대시보드
- **VM 상태 패널**: 모든 VM의 실행 상태를 한눈에 확인
- **리소스 모니터**: CPU, RAM, 디스크 사용량 실시간 표시
- **빠른 액션**: 새 VM 생성, 전체 백업, 스냅샷 생성

### VM 관리 인터페이스
- **VM 카드 뷰**: 각 VM을 카드 형태로 표시
- **원클릭 제어**: 시작/중지/재시작 버튼
- **실행 모드 선택**: 심리스/윈도우 모드 토글

### 애플리케이션 런처
- **통합 런처**: 모든 VM의 애플리케이션을 한 곳에서 실행
- **VM 선택기**: 앱 실행 시 대상 VM 선택
- **모드 선택**: 심리스/윈도우 모드 선택

### 설정 및 구성
- **심리스 모드 기본값**: VM별 기본 실행 모드 설정
- **공유 설정**: 클립보드 및 파일 공유 옵션
- **리소스 할당**: VM별 CPU, RAM 할당량 조정

---

## 📦 설치 및 초기 설정

### 1. 시스템 설치
- Anaconda를 통한 Arch Linux 설치
- KDE Plasma + Wayland 자동 구성
- QEMU/KVM 및 Kluis 도구 설치

### 2. 첫 VM 생성
- 설치 완료 후 첫 VM 생성 마법사 실행
- 비심리스 모드로 초기 설정 진행
- 기본 애플리케이션 설치 및 구성

### 3. 사용 환경 준비
- VM 설정 완료 후 심리스 모드 활성화
- 데스크톱 바로가기 자동 생성
- 공유 폴더 및 클립보드 설정

---

## 🎮 사용자 워크플로우

### 일반적인 사용
1. **애플리케이션 실행**: 데스크톱 아이콘 클릭 → 심리스 모드로 실행
2. **독립 실행**: 우클릭 → "새 창에서 열기" → 독립 윈도우로 실행
3. **VM 관리**: Kluis Control Center에서 VM 상태 확인 및 제어

### VM 생성 및 설정
1. **새 VM 생성**: Control Center → "새 VM" → 템플릿 선택
2. **초기 설정**: 비심리스 모드에서 OS 설치 및 기본 설정
3. **운영 전환**: 설정 완료 후 심리스 모드로 전환

### 백업 및 복구
1. **스냅샷 생성**: VM 우클릭 → "스냅샷 생성"
2. **백업**: 자동 또는 수동 백업 실행
3. **복구**: 문제 발생 시 스냅샷으로 즉시 복원

---

## 🚀 편의성 중심 설계

### 사용자 친화성
- VM 존재를 명확히 인식하면서도 쉬운 조작
- 직관적인 GUI와 간단한 CLI 명령어
- 상황에 맞는 실행 모드 선택

### 유연성
- 심리스/윈도우 모드 자유 전환
- VM별 독립적인 설정 관리
- 템플릿 기반 빠른 VM 생성

### 자동화
- 리소스 자동 할당 및 최적화
- 백그라운드 백업 및 상태 관리
- 지능적인 VM 선택 및 실행

---

## 🔒 기본 보안 및 격리

### 애플리케이션 격리
- 호스트 시스템과 완전 분리된 실행 환경
- VM 간 선택적 네트워크 격리

### 데이터 보호
- 스냅샷 기반 즉시 롤백
- 자동 백업 시스템
- 공유 데이터 접근 제어

### 시스템 보안
- 호스트에 직접 설치 제한
- VM을 통한 제어된 실행 환경
- 격리된 네트워크 환경 옵션
